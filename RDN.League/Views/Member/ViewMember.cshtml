@using RDN.Library.Cache
@model RDN.Portable.Classes.Account.Classes.MemberDisplay
@{
    ViewBag.Title = Model.DerbyName + " (" + Model.PlayerNumber + ")";
    Layout = "~/Views/Shared/_Layout.cshtml";
    var memId = RDN.Library.Classes.Account.User.GetMemberId();
    bool isAdminOfLeague = RDN.Library.Cache.MemberCache.IsSecretaryOrBetterOfLeague(memId);
}


<ol class="breadcrumb">
    <li><a href="@RDN.Utilities.Config.ConfigManager.InternalSite">Home</a></li>
    <li class="active">Profile</li>
</ol>


<div class="row">
    <div class="col-xs-12">
        <div class="panel panel-default margin-top-20">
            <div class="panel-heading">
                <h3 style="margin-top:5px !important"><i class="fa fa-user"></i> @Model.DerbyName</h3>
            </div>
            <div class="panel-body">
                <div class="row">
                    <div class="col-sm-12 col-md-3 text-center">
                        @if (Model.Photos.Where(x => x.IsPrimaryPhoto == true).FirstOrDefault() != null)
                        {
                            <img style="width: 100%; max-width:400px" alt="@Model.Photos.Where(x => x.IsPrimaryPhoto == true).FirstOrDefault().Alt" src="@Model.Photos.Where(x => x.IsPrimaryPhoto == true).FirstOrDefault().ImageUrl" class="img-rounded" />
                        }
                        else if (Model.Gender == RDN.Portable.Classes.Account.Enums.GenderEnum.Female)
                        {
                            <img style="width: 100%; max-width: 400px" src="@Url.Content("~/content/roller-girl.jpg")" alt="roller derby girl" class="img-rounded" />
                        }
                        else
                        {
                            <img style="width: 100%; max-width: 400px" src="@Url.Content("~/content/roller-person.gif")" alt="roller derby boy" class="img-rounded" />
                        }
                        <p>
                            <h3><b>@Model.Firstname @Model.LastName</b></h3>
                        </p>
                        <p>
                           <i>@Model.PlayerNumber</i>
                        </p>
                        <p>
                            @Model.Email
                        </p>
                        @*<div class="row text-center">
                            @if (isAdminOfLeague || !Model.Settings.Hide_Email_From_League || Model.MemberId == memId)
                            {
                                <a href="mailto:@Model.Email" class="" target="_blank">@Model.Email</a>
                            }
                        </div>*@
                        <div class="row text-center margin-bottom-15">
                            @if (isAdminOfLeague || !Model.Settings.Hide_Phone_Number_From_League || Model.MemberId == memId)
                                {
                                <a class="btn btn-info" href="tel:@Model.PhoneNumber" target="_blank"><i class="fa fa-phone fa-lg"></i></a>
                                }
                            @if (isAdminOfLeague || !Model.Settings.Hide_Email_From_League || Model.MemberId == memId)
                            {
                                <a class="btn btn-info" href="mailto:@Model.Email" target="_blank"><i class="fa fa-at fa-lg"></i></a>
                            }

                            <a class="btn btn-info" href="@Url.Content("~/messages/new/person/" + Model.MemberId.ToString().Replace("-",""))" target="_blank"><i class="fa fa-envelope-o"></i></a>

                        </div>
                    </div>

                    <div class="col-sm-12 col-md-9">
                        <div class="panel panel-default">
                            <div class="panel-body no-padding">
                                <ul class="nav nav-tabs padding-top-5" id="myTab">
                                    <li class="active margin-left-5"><a href="#Personal">Profile</a></li>
                                    @if (RDN.Library.Cache.Singletons.SiteSingleton.Instance.SiteType == RDN.Library.Classes.Site.Enums.SiteType.RollerDerby)
                                    {
                                        <li class="margin-left-5"><a href="#Skating">Skating</a></li>
                                    }
                                    <li class="margin-left-5"><a href="#Contacts">Contacts</a></li>
                                    <li class="margin-left-5"><a href="#Memberships">Memberships</a></li>
                                </ul>
                                <div class="tab-content padding-15">
                                    <div class="tab-pane active" id="Personal">
                                        <div class="row">
                                            <div class="col-xs-12 col-sm-4">
                                                <div class="well">
                                                    <table class="full-width">
                                                        <tr>
                                                            <td rowspan="2" class="padding-left-10">
                                                                @if (Model.Gender == RDN.Portable.Classes.Account.Enums.GenderEnum.Female)
                                                                {
                                                                    <i class="fa fa-female fa-3x"></i>
                                                                }
                                                                @if (Model.Gender == RDN.Portable.Classes.Account.Enums.GenderEnum.Male)
                                                                {
                                                                    <i class="fa fa-male fa-3x"></i>
                                                                }
                                                            </td>
                                                            <td class="text-right">Gender</td>
                                                        </tr>
                                                        <tr>
                                                            <td class="text-right font30">
                                                                @if (Model.Gender == RDN.Portable.Classes.Account.Enums.GenderEnum.Female)
                                                                {
                                                                    <span>Female</span>
                                                                }
                                                                @if (Model.Gender == RDN.Portable.Classes.Account.Enums.GenderEnum.Male)
                                                                {
                                                                    <span>Male</span>
                                                                }
                                                            </td>
                                                            </tr>
                                                    </table>
                                                </div>
                                            </div>
                                            @if (Model.HeightFeet > 0)
                                            {
                                                <div class="col-xs-12 col-sm-4">
                                                    <div class="well">
                                                        <table class="full-width">
                                                            <tr>
                                                                <td rowspan="2" class="padding-left-10">
                                                                    <i class="fa fa-long-arrow-up fa-3x"></i>
                                                                </td>
                                                                <td class="text-right">Height</td>
                                                            </tr>
                                                            <tr>
                                                                <td class="text-right font30">
                                                                    <span>@Model.HeightFeet' @Model.HeightInches</span>
                                                                </td>
                                                            </tr>
                                                        </table>
                                                    </div>
                                                </div>
                                            }
                                            @if (Model.WeightLbs > 0)
                                            {
                                                <div class="col-xs-12 col-sm-4">
                                                    <div class="well">
                                                        <table class="full-width">
                                                            <tr>
                                                                <td rowspan="2" class="padding-left-10">
                                                                    <i class="fa fa-dashboard fa-3x"></i>
                                                                </td>
                                                                <td class="text-right">Weight (lbs)</td>
                                                            </tr>
                                                            <tr>
                                                                <td class="text-right font30">
                                                                    <span>@Model.WeightLbs</span>
                                                                </td>
                                                            </tr>
                                                        </table>
                                                    </div>
                                                </div>
                                            }
                                           @if (Model.DOB < DateTime.UtcNow.AddYears(-5) && !Model.Settings.Hide_DOB_From_Public)
                                            {
                                                <div class="col-xs-12 col-sm-6">
                                                    <div class="well">
                                                        <table class="full-width">
                                                            <tr>
                                                                <td rowspan="2" class="padding-left-10">
                                                                    <i class="fa fa-birthday-cake fa-3x"></i>
                                                                </td>
                                                                <td class="text-right">Birthday</td>
                                                            </tr>
                                                            <tr>
                                                                <td class="text-right font30">
                                                                    <span>@Model.DOB.ToShortDateString()</span>
                                                                </td>
                                                            </tr>
                                                        </table>
                                                    </div>
                                                </div>
                                            }
                                            <div class="col-xs-12">

                                                <div class="panel panel-default ">
                                                    <div class="panel-heading">Biography</div>
                                                    <div class="panel-body">
                                                        @Html.Raw(Model.Bio)
                                                    </div>
                                                </div>

                                            </div>
                                        </div>
                                    </div>
                                    @if (RDN.Library.Cache.Singletons.SiteSingleton.Instance.SiteType == RDN.Library.Classes.Site.Enums.SiteType.RollerDerby)
                                        {

                                        <div role="tabpanel" class="tab-pane" id="Skating">
                                            <h4 class="no-margin-top">
                                                Insurance Numbers
                                            </h4>
                                            @if (RDN.Library.Cache.MemberCache.CheckIsLeagueSubscriptionPaid(memId) || memId == Model.MemberId)
                                            {
                                                <div class="row">
                                                    <div class="col-xs-12 col-md-6">
                                                        <div class="well">
                                                            <table class="full-width">
                                                                <tr>
                                                                    <td rowspan="2" class="padding-left-10 b font20">
                                                                        WFTDA
                                                                    </td>
                                                                    <td class="text-right">@Model.InsuranceNumWftda</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-right font20">
                                                                        <span>
                                                                            @if (Model.InsuranceNumWftdaExpires.HasValue)
                                                                            {
                                                                                @Model.InsuranceNumWftdaExpires.GetValueOrDefault().ToString("MM/dd/yyyy")
                                                                            }
                                                                        </span>
                                                                    </td>
                                                                </tr>
                                                            </table>
                                                        </div>
                                                    </div>
                                                    <div class="col-xs-12 col-md-6">
                                                        <div class="well">
                                                            <table class="full-width">
                                                                <tr>
                                                                    <td rowspan="2" class="padding-left-10 b font20">
                                                                        USARS
                                                                    </td>
                                                                    <td class="text-right">@Model.InsuranceNumUsars</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-right font20">
                                                                        <span>
                                                                            @if (Model.InsuranceNumUsarsExpires.HasValue)
                                                                            {
                                                                                @Model.InsuranceNumUsarsExpires.GetValueOrDefault().ToString("MM/dd/yyyy")
                                                                            }
                                                                        </span>
                                                                    </td>
                                                                </tr>
                                                            </table>
                                                        </div>
                                                    </div>
                                                    <div class="col-xs-12 col-md-6">
                                                        <div class="well">
                                                            <table class="full-width">
                                                                <tr>
                                                                    <td rowspan="2" class="padding-left-10 b font20">
                                                                        CRDI
                                                                    </td>
                                                                    <td class="text-right">@Model.InsuranceNumCRDI</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-right font20">
                                                                        <span>
                                                                             @if (Model.InsuranceNumCRDIExpires.HasValue)
                                                                            {
                                                                                @Model.InsuranceNumCRDIExpires.GetValueOrDefault().ToString("MM/dd/yyyy")
                                                                            }
                                                                        </span>
                                                                    </td>
                                                                </tr>
                                                            </table>
                                                        </div>
                                                    </div>
                                                    <div class="col-xs-12 col-md-6">
                                                        <div class="well">
                                                            <table class="full-width">
                                                                <tr>
                                                                    <td rowspan="2" class="padding-left-10 b font20">
                                                                        Other
                                                                    </td>
                                                                    <td class="text-right">@Model.InsuranceNumOther</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="text-right font20">
                                                                        <span>
                                                                            @if (Model.InsuranceNumOtherExpires.HasValue)
                                                                            {
                                                                                @Model.InsuranceNumOtherExpires.GetValueOrDefault().ToString("MM/dd/yyyy")
                                                                            }
                                                                        </span>
                                                                    </td>
                                                                </tr>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            }
                                            else
                                            {
                                                <h4>Subscribe to view Insurance Numbers of each member in your league! <a href="@Url.Content("~/billing/league/" + RDN.Library.Cache.MemberCache.GetLeagueIdOfMember(RDN.Library.Classes.Account.User.GetMemberId()).ToString().Replace("-", ""))">Subscribe Here</a></h4>
                                            }
                                        </div>
                                        }

                                    <div id="Contacts" class="tab-pane">
                                        @if ((MemberCache.IsSecretaryOrBetterOfLeague(memId) && MemberCache.CheckIsLeagueSubscriptionPaid(memId)) || memId == Model.MemberId)
                                            {
                                                if (Model.MemberContacts.Count == 0)
                                                {
                                                    <div>Member has no personal contacts</div>
                                                    <br />
                                                }
                                                <div class="row">
                                                    <div class="col-xs-12 text-right margin-bottom-10">
                                                        <a class="btn btn-primary" href="@Url.Content("~/member/contacts/" + Model.MemberId.ToString().Replace("-", ""))"><i class="fa fa-plus-circle"></i> Add Contacts To Member</a>
                                                    </div>
                                                </div>
                                            <div class="row">
                                                @foreach (var contact in Model.MemberContacts)
                                                {
                                                    <div class="col-xs-12 col-sm-6" id="@contact.ContactId-div">
                                                        <div class="panel panel-default" style="min-height:260px">
                                                            <div class="panel-heading">
                                                                <h4 class="no-margin"><i class="fa fa-user"></i> @contact.Firstname @contact.Lastname</h4>
                                                            </div>
                                                            <div class="panel-body">
                                                                <table>
                                                                    <tr>
                                                                        <td class="b"><i class="fa fa-suitcase"></i>&nbsp;</td>
                                                                        <td>
                                                                            @RDN.Utilities.Enums.EnumExt.ToFreindlyName(contact.ContactType)
                                                                        </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td class="b"><i class="fa fa-envelope"></i>&nbsp;</td>
                                                                        <td>
                                                                            <a href="mailto:@contact.Email">@contact.Email</a>
                                                                        </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td class="b"><i class="fa fa-phone"></i>&nbsp;</td>
                                                                        <td>
                                                                            <a href="tel:@contact.PhoneNumber">
                                                                                @contact.PhoneNumber
                                                                            </a>
                                                                        </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td class="b" style="vertical-align:top">
                                                                            @if (contact.Addresses != null && contact.Addresses.FirstOrDefault() != null)
                                                                            {
                                                                                <span><i class="fa fa-map-marker"></i>&nbsp;</span>
                                                                            }
                                                                        </td>
                                                                        <td>
                                                                            @if (contact.Addresses != null && contact.Addresses.FirstOrDefault() != null)
                                                                            {
                                                                            @contact.Addresses.FirstOrDefault().Address1<br />
                                                                            if (!String.IsNullOrEmpty(contact.Addresses.FirstOrDefault().Address2))
                                                                            {
                                                                            @contact.Addresses.FirstOrDefault().Address2<br />
                                                                            }
                                                                            if (!String.IsNullOrEmpty(contact.Addresses.FirstOrDefault().CityRaw))
                                                                            {
                                                                            @contact.Addresses.FirstOrDefault().CityRaw<br />}
                                                                            if (!String.IsNullOrEmpty(contact.Addresses.FirstOrDefault().StateRaw))
                                                                            {
                                                                            @contact.Addresses.FirstOrDefault().StateRaw<br />
                                                                            }
                                                                            if (!String.IsNullOrEmpty(contact.Addresses.FirstOrDefault().Zip))
                                                                            {
                                                                            @contact.Addresses.FirstOrDefault().Zip<br />
                                                                            }
                                                                            if (!String.IsNullOrEmpty(contact.Addresses.FirstOrDefault().Country))
                                                                            {
                                                                            @contact.Addresses.FirstOrDefault().Country
                                                                            }
                                                                            <br />
                                                                            <a class="btn btn-default btn-xs margin-top-5" href="http://www.bing.com/maps/default.aspx?q=@contact.Addresses.FirstOrDefault().Address1+@contact.Addresses.FirstOrDefault().Address2,+@contact.Addresses.FirstOrDefault().CityRaw,+@contact.Addresses.FirstOrDefault().StateRaw+@contact.Addresses.FirstOrDefault().Zip+@contact.Addresses.FirstOrDefault().Country" target="_blank"><i class="fa fa-map-marker"></i> View Map</a>
                                                                            }
                                                                        </td>
                                                                    </tr>

                                                                </table>
                                                            </div>
                                                        </div>
                                                    </div>
                                                }

                                            </div>
                                            }
                                            else
                                            {
                                            <div class="subPleaseSubscribeMessage">Subscribe to RDNation to store/view Contacts for members in your league! <a href="@Url.Content("~/billing/league/" + RDN.Library.Cache.MemberCache.GetLeagueIdOfMember(memId).ToString().Replace("-", ""))">Subscribe Here</a></div>
                                            }

                                        <small>Only Managers of the league can see this information.</small>
                                    </div>
                                    <div id="Memberships" class="tab-pane">
                                        <div class="row">
                                            @foreach (var league in Model.Leagues)
                                            {
                                                if (!String.IsNullOrEmpty(league.Name))
                                                {

                                                <div class="col-xs-12 col-sm-6" >
                                                    <div class="well padding-15">
                                                        @if (league.Logo != null)
                                                            {
                                                            <a href="@Url.Content(System.Configuration.ConfigurationManager.AppSettings["LeagueUrl"] + RDN.Utilities.Strings.StringExt.ToSearchEngineFriendly(league.Name.Replace(" ", "-")) + "/" + league.LeagueId.ToString().Replace("-", ""))">

                                                                <img style="max-height:200px" alt="@league.Name" src="@league.Logo.ImageUrl" />

                                                            </a>
                                                            }
                                                        <div class="caption">
                                                            <h4 class="no-margin">
                                                                <a href="@Url.Content(System.Configuration.ConfigurationManager.AppSettings["LeagueUrl"] + RDN.Utilities.Strings.StringExt.ToSearchEngineFriendly(league.Name.Replace(" ", "-")) + "/" + league.LeagueId.ToString().Replace("-", ""))">
                                                                    @league.Name
                                                                </a>

                                                            </h4>
                                                            @if (league.HasLeftLeague)
                                                            {
                                                                <div class="margin-top-10">
                                                                    <b> retired </b> @league.DepartureDate.GetValueOrDefault().ToShortDateString()
                                                                </div>
                                                            }
                                                        </div>
                                                    </div>
                                                </div>
                                                }
                                            }
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<script type="text/javascript">
    
    $('#myTab a').click(function (e) {
        e.preventDefault();
        $(this).tab('show');
    });
</script>