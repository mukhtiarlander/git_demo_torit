@using RDN.Library.Classes.Calendar
@using RDN.League.Models.Utilities
@using RDN.Library.Cache
@model RDN.Portable.Classes.Controls.Calendar.Calendar
@{
    ViewBag.Title = "Modify Calendar Settings";
    Layout = "~/Views/Shared/_Layout.cshtml";
    Guid memId = RDN.Library.Classes.Account.User.GetMemberId();
}

<ol class="breadcrumb">
    <li><a href="@RDN.Utilities.Config.ConfigManager.InternalSite">Home</a></li>
    @if (MemberCache.GetCalendarDefaultView(memId) == RDN.Portable.Classes.Account.Enums.Settings.CalendarDefaultViewEnum.List_View)
    {
        <li><a href="@Url.Content("~/calendar/" + Model.OwnerEntity + "/" + Model.CalendarId.ToString().Replace("-", ""))">Calendar</a></li>
    }
    else
    {
        <li><a href="@Url.Content("~/calendar/view/" + Model.OwnerEntity + "/" + Model.CalendarId.ToString().Replace("-", ""))">Calendar</a></li>
    }
    <li class="active">Settings</li>
</ol>
@if (ViewBag.IsSuccessful)
{

    <div class="alert alert-success" role="alert">Updated Successfully!</div>

}
<div class="col-md-offset-1  col-md-10  col-xs-12">
    <h2 class="text-center">
        
    </h2>

</div>
<div class="col-md-offset-1 col-md-10 col-xs-12">
    <div class="panel panel-default">
        <div class="panel-heading">
            <h3 class="margin-bottom-10 margin-top-5"><i class="fa fa-cogs"></i> Calendar Settings</h3>
            <span class="text-muted">Modify the calendar settings for your organization.</span>
        </div>
        @using (Html.BeginForm("CalendarSettings", "Calendar", FormMethod.Post))
        {
            <div class="panel-body">
           
                <table class="table no-margin-bottom table-bordered">
                    <tr>
                        <td class="b text-right">TimeZone of Calendar:</td>
                        <td>@Html.DropDownListFor(x => x.TimeZoneId, new SelectList(Model.TimeZones, "ZoneId", "LocationGMT"), "Select TimeZone...", new { @class="form-control"})</td>
                    </tr>
                    <tr>
                        <td class="b text-right">
                            Allow Self Check Ins:
                        </td>
                        <td>
                           
                            @Html.CheckBoxFor(x => x.AllowSelfCheckIn) 
                            Allows user to check their
                            self into the event.
                            
                        </td>
                    </tr>
                    <tr>
                        <td class="b  text-right">
                            Not Present Required For Check In:
                        </td>
                        <td>
                            @Html.CheckBoxFor(x => x.NotPresentCheckIn) If Enabled, you will NOT need to count the @RDN.Utilities.Config.ConfigManager.NameOfMembers as "Not Present" to effect their attendance percentage. <a href="@RDN.Library.Classes.Config.LibraryConfig.WikiSite/Calendar_and_Attendance_Tracking#Calendar_Point_Types_Explained" target="_blank">Read more here.</a>
                        </td>
                    </tr>
                    <tr>
                        <td class="b  text-right">
                            Disable Birthdays:
                        </td>
                        <td>
                            @Html.CheckBoxFor(x => x.DisableBirthdays) Removes Birthdays from Calendar
                        </td>
                    </tr>
                    <tr>
                        <td class="b  text-right">
                            Disable @RDN.Utilities.Config.ConfigManager.NameOfMembers Start Date:
                        </td>
                        <td>
                            @Html.CheckBoxFor(x => x.DisableSkatingStartDates) Removes @RDN.Utilities.Config.ConfigManager.NameOfMembers Start Date From Calendar
                        </td>
                    </tr>
                    <tr>
                        <td class="b  text-right">
                            Locations:
                        </td>
                        <td>
                            <a class="btn btn-warning btn-xs" href="@Url.Content("~/location/all")"><i class="fa fa-map-marker"></i> Edit Locations</a>
                        </td>
                    </tr>
                    <tr>
                        <td class="b  text-right">
                            Event Types:
                        </td>
                        <td>
                            <a class="btn btn-warning btn-xs" href="@Url.Content("~/calendar/event-type/new/" + Model.OwnerEntity.ToString() + "/" + Model.CalendarId.ToString().Replace("-", ""))">Add New Event Type</a> 
                            <br />
                            <small class="i">
                                Used for describing what type of event it is,
                                as well as point structures for that event.
                            </small>
                        </td>
                    </tr>
                </table>
                <div class="panel panel-default margin-top-10">
                    <div class="panel-heading">
                        <i class="fa fa-star"></i> Points
                    </div>
                    <div class="panel-body no-padding">
                        <table class="table table-hover no-margin-bottom">
                            <thead>
                                <tr>
                                    <th class="text-right">
                                        Event Type
                                    </th>
                                    <th class="tht">
                                        Color
                                    </th>
                                    <th class="tht">
                                        Present
                                    </th>
                                    <th class="tht">
                                        Partial
                                    </th>
                                    <th class="tht">
                                        Not Present
                                    </th>
                                    <th class="tht">
                                        Excused
                                    </th>
                                    <th class="tht">
                                        Tardy
                                    </th>
                                    <th class="tht"></th>
                                </tr>
                            </thead>
                            @foreach (var type in Model.EventTypes)
                            {
                                <tr>
                                    <td class="text-right">
                                        @type.EventTypeName
                                    </td>
                                    <td>
                                        @if (!String.IsNullOrEmpty(type.ColorTempSelected))
                                        {
                                            <label class="label" style="background-color: @type.ColorTempSelected">@type.ColorName</label>
                                        }
                                    </td>
                                    <td class="text-center">
                                        @type.PointsForPresent
                                    </td>
                                    <td class="text-center">
                                        @type.PointsForPartial
                                    </td>
                                    <td class="text-center">
                                        @type.PointsForNotPresent
                                    </td>
                                    <td class="text-center">
                                        @type.PointsForExcused
                                    </td>
                                    <td class="text-center">
                                        @type.PointsForTardy
                                    </td>
                                    <td>
                                        <a class="btn btn-success btn-xs" href="@Url.Content("~/calendar/event-type/edit/" + Model.OwnerEntity + "/" + Model.CalendarId.ToString().Replace("-", "") + "/" + type.CalendarEventTypeId)"><i class="fa fa-pencil"></i> Edit</a>
                                        <a class="btn btn-xs btn-danger btnCalenderEventType" data-id="@type.CalendarEventTypeId" title="Delete">
                                            <i class="fa fa-trash"></i> Delete
                                        </a>
                                    </td>
                                </tr>
                            }
                        </table>
                    </div>
                </div>
                @Html.HiddenFor(x => x.CalendarId)
                @Html.HiddenFor(x => x.EntityName)
                @Html.HiddenFor(x => x.OwnerEntity)
          
            </div>
            <div class="panel-footer">
                <button type="submit" class="btn btn-primary"><i class="fa fa-save"></i> Update Settings</button>
            </div>
        }
    </div>
</div>
<script type="text/javascript">
    $(function () {
        $('.btnCalenderEventType').btsConfirmButton({ msg: "Confirm" }, Calendar.DeleteCalendarEventType);
    });
</script>